{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../App.svelte"
  ],
  "sourcesContent": [
    "<script>\n  /* TODO: openlp importer */\n  /* TODO: stage view overlay */\n  import { onMount, onDestroy } from \"svelte\";\n  import { writableGun } from './gunstores.js';\n\n  onMount(function(){\n    document.addEventListener('keydown', function(event) {\n      if (editingSong) {\n        if (event.code == 'Enter' &&\n            event.getModifierState(\"Control\") +\n            event.getModifierState(\"Meta\") > 1) {\n              addNewVerse();\n            }\n      };\n      if (event.code == 'ArrowDown' || event.code == 'ArrowUp'\n       || event.code == 'ArrowLeft' || event.code == 'ArrowRight'\n      ) event.preventDefault();\n\n      if (event.code == 'ArrowDown') {\n        $curVerseIndex = Math.min($curVerseIndex+1, curVerses.length-1);\n        scrollToVerse($curVerseIndex);\n      } else if (event.code == 'ArrowUp') {\n        $curVerseIndex = Math.max($curVerseIndex-1, 0);\n        scrollToVerse($curVerseIndex);\n      } else if (event.code == 'ArrowLeft') {\n        $curSongIndex = Math.max($curSongIndex-1, 0);\n      } else if (event.code == 'ArrowRight') {\n        $curSongIndex = Math.min($curSongIndex+1, playlist.length-1);\n      }\n    });\n  });\n\n  let songs = [\n    {\n      name: \"A Safe Stronghold Our God is Still\",\n      author: \"Martin Luther\",\n      order: \"s1 s2 s3 s1 s1 s2 s3 s3 s3\",\n      verses: {\n        s1: `As safe a stronghold our God is still,\nOn earth is not His fellow.`,\n        s2: `With force of arms we nothing can,\nShall conquer in the battle.`,\n        s3: `And were this world all devils o’er,\nA word shall quickly slay him.`\n      }\n    }\n  ];\n  let songsByName = new Map();\n  let songFilter = \"\";\n  let filteredSongs = songs;\n  let filterFocused = false;\n  let editingSong = false;\n\n  GUN_SUPER_PEERS = GUN_SUPER_PEERS || ['http://127.0.0.1/gun'];\n  let gun = Gun(GUN_SUPER_PEERS);\n  let overlay = gun.get('songs').get(window.location.hash || 'demo');\n\n  /* Synced variables */\n  let shown = writableGun(overlay.get('show'), false);\n  let line1 = writableGun(overlay.get('line1'), '');\n  let bodyclass = writableGun(overlay.get('bodyclass'), '');\n  let curSongIndex = writableGun(overlay.get('curSongIndex'), 0);\n  let curVerseIndex = writableGun(overlay.get('curVerseIndex'), 0);\n\n  let playlist = [\n    songs[0],\n  ];\n  let curSong = playlist[0];\n  let curVerses = curSong.verses || [];\n  let newId = 's1'; generateNewId();\n  let newVerse = '';\n\n  $: if ($curSongIndex >= playlist.length) $curSongIndex = playlist.length-1;\n  $: curSong = playlist[$curSongIndex];\n  $: curVerses = getSongVerses(curSong);\n  $: $line1 = curVerses[$curVerseIndex];\n  $: filteredSongs = songFilter ? songs.filter(matchesSong) : songs;\n\n  function getSongVerses(song) {\n    let verses = [];\n    if (song) {\n      if (song.order.trim()) {\n        song.order.split(' ').forEach(id => {\n          if (song.verses[id]) verses.push(song.verses[id]);\n        });\n      } else {\n        return Object.values(song.verses)\n      }\n    }\n    return verses;\n  }\n\n  function matchesSong(song) {\n    const prefix = songFilter.normalize('NFD').replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase();\n    const nameLower = song.name.normalize('NFD').replace(/[\\u0300-\\u036f]/g, \"\").toLowerCase();\n    return (\n      nameLower.startsWith(prefix) ||\n      (prefix.length >= 2 && nameLower.includes(' '+prefix))\n    );\n  }\n\n  function addToPlaylist(song) {\n    playlist.push(song);\n    playlist = playlist;\n  }\n\n  function playlistRemover(songIndex) {\n    return function() {\n      playlist = playlist.filter((h, j) => (songIndex !== j));\n    }\n  }\n\n  function songSelector(i) {\n    return function() {$curSongIndex = i}\n  }\n\n  function verseSelector(i) {\n    return function() {$curVerseIndex = i}\n  }\n  function verseRemover(id) {\n    return function() {\n      if (!newVerse) newId = id;\n      delete curSong.verses[id]\n    };\n  }\n  function addNewVerse() {\n    if (newId && !curSong.verses[newId])\n      curSong.verses[newId] = newVerse;\n    /* Clean new verse */\n    newVerse = '';\n    generateNewId();\n  }\n  function generateNewId() {\n    if (!curSong || !curSong.verses) return;\n    while (curSong.verses[newId]) {\n      newId = newId.replace(/\\d+/, (n)=>(parseInt(n)+1))\n    }\n  }\n\n  function addSong() {\n    let newSong = {\n      name: '',\n      author: '',\n      order: '',\n      verses: {}\n    }\n    songs.push(newSong);\n    addToPlaylist(newSong);\n    $curSongIndex = playlist.length - 1;\n    editingSong = true;\n    newId = 's1';\n  }\n\n  function scrollToVerse(i) {\n    let e = document.querySelector('.verse-item:nth-child('+i+')');\n    e && e.scrollIntoView();\n  }\n\n  function toggleShow() {\n    shown = !shown;\n    overlay.get('show').put(shown);\n  }\n</script>\n\n<style>\n  :global(body) {\n    color: white;\n  }\n  .songs-filter {\n    display: block;\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    max-height: calc(100vh - 6rem);\n    position: absolute;\n    left: -100%;\n    overflow: scroll;\n    z-index: 30;\n  }\n  .songs-filter.show {\n    left: 0;\n  }\n  .songs-filter .song-item {\n    padding: .75rem .5rem;\n  }\n\n  .song-item {\n    width: 100%;\n    margin: 0;\n    padding: 0;\n    text-align: left;\n    border: 1px solid black;\n  }\n  .song-item:hover {\n    border: 1px solid blue;\n  }\n  .playlist {\n    display: inline-block;\n    overflow: auto;\n    vertical-align: top;\n    width: 100%;\n    margin: 1rem 0;\n  }\n  .song-set {\n    width: auto;\n    padding: 0 .75rem;\n    margin: 0;\n    text-align: left;\n  }\n  .song-remove {\n    margin: 0;\n    max-width: 2rem;\n    padding: .25rem .5rem;\n  }\n  .song-add {\n    float:right\n  }\n\n  .verses {\n    display: inline-block;\n    overflow: auto;\n    width: 100%;\n  }\n  .verse-item {\n    border-bottom: 1px solid;\n    border-color: #3c3b3b;\n    padding: .5rem .5rem;\n    margin: 0;\n    width: 100%;\n  }\n  .verse-item:hover {\n    border-color: wheat;\n  }\n  .verse-item.active {\n    border-color: yellow;\n    color: white;\n    background: #375a7f;\n  }\n  .verse-item:last-child {\n    border-bottom: none;\n  }\n  p[contenteditable=\"true\"] {\n    background-color: white;\n    color: black;\n    min-height: 3rem;\n    max-width: calc(100% - 4rem);\n    padding: .5rem .5rem;\n    white-space: pre;\n  }\n  p[contenteditable=\"true\"]:focus-within {\n    background-color: lightyellow;\n  }\n  .verse-id {\n    float: right;\n    padding: .5rem;\n  }\n  .verse-new-id {\n    float: right;\n    padding: 0 0 0 .25rem;\n    width: 1.8rem;\n  }\n  .verse-new-item {\n    min-height: 3rem;\n  }\n  .verse-add {\n    float: right;\n  }\n  .verse-remove {\n    float: right;\n    padding: .5rem 0.75rem;\n  }\n\n.bottom-buttons {\n    position: sticky;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n  }\n  .bottom-buttons button {\n    margin: 0;\n    padding: 1rem 0.25rem;\n  }\n</style>\n\n<p class=\"bodyclass\">\n  Téma:\n  <select bind:value={$bodyclass}>\n    <option value=\"\" selected>Predvolené</option>\n    <option value=\"simple-with-shadow\">Jednoduché s tieňom</option>\n  </select>\n</p>\n\n<div class=\"input-group\" style=\"width: 100%; display: flex;\">\n  <input class=\"form-control\" type=\"text\" placeholder=\"filter\"\n    bind:value={songFilter}\n    on:focus={()=>{filterFocused=true}}\n    />\n  <button type=\"button\" class=\"form-control btn btn-secondary\"\n    style=\"max-width: 2rem; padding: .25rem;\"\n    on:click={()=>{songFilter=''}}\n    >×</button>\n</div>\n\n<div class=\"songs-filter\" class:show={filterFocused}>\n  {#each filteredSongs as song}\n    <button class=\"song-item btn\"\n      class:btn-primary={song==curSong}\n      on:click={()=>{addToPlaylist(song); filterFocused=false}}\n    >{song.name}</button>\n  {/each}\n</div>\n\n<div class=\"playlist\">\n  Playlist:\n  {#each playlist as song, i}\n  <div class=\"song-item btn-group\">\n    <button class=\"song-set btn\"\n      class:btn-primary={$curSongIndex==i}\n      on:click={songSelector(i)}\n    >{song.name||'---'}</button>\n    <button class=\"btn btn-secondary song-remove\" on:click={playlistRemover(i)}>×</button>\n  </div>\n  {/each}\n</div>\n\n<div class=\"verses\">\n  <span>{curSong.name}</span> - <span>{curSong.author}</span>\n  <button class=\"song-edit btn\" class:btn-danger={editingSong}\n          on:click={()=>{editingSong = !editingSong; generateNewId();}}>✎</button>\n  <button class=\"song-add btn\" on:click={addSong}>+</button>\n\n  {#if editingSong}\n    <input class=\"form-control\" type=\"text\" placeholder=\"name\" bind:value={curSong.name} />\n    <input class=\"form-control\" type=\"text\" placeholder=\"author\" bind:value={curSong.author} />\n    <input class=\"form-control\" type=\"text\" placeholder=\"order\" bind:value={curSong.order} />\n    {#each Object.entries(curSong.verses) as [id, verse]}\n    <button class=\"verse-remove btn btn-secondary\" on:click={()=>{verseRemover(id)}}>×</button>\n    <span class=\"verse-id\">{id}</span>\n    <p class=\"verse-item\" contenteditable=\"true\" bind:innerHTML={curSong.verses[id]}></p>\n    {/each}\n    <button class=\"verse-add btn btn-success\" on:click={addNewVerse}>+</button>\n    <input class=\"form-control verse-new-id\" type=\"text\" placeholder=\"id\" bind:value={newId} />\n    <p class=\"verse-new-item\" contenteditable=\"true\" bind:innerHTML={newVerse}></p>\n  {:else}\n    {#each curVerses as verse, i}\n    <p class=\"verse-item\" class:active={$curVerseIndex==i} on:click={verseSelector(i)}>\n      {@html verse.replace(/\\n/g,'<br>')}\n    </p>\n    {/each}\n  {/if}\n</div>\n\n<div class=\"bottom-buttons btn-group\">\n  <button class=\"btn btn-primary\"\n          on:click={function(){$curSongIndex -= 1}}\n          disabled={$curSongIndex <= 0}>↑ Pieseň</button>\n  <button class=\"btn btn-primary\"\n          on:click={function(){$curSongIndex += 1}}\n          disabled={$curSongIndex >= playlist.length-1}>Pieseň ↓</button>\n\n  <button class=\"control-button btn\" on:click={toggleShow} class:btn-danger={shown} class:btn-success={!shown}>\n    {#if shown}Skryť{:else}Zobraziť{/if}\n  </button>\n\n  <button class=\"btn btn-primary\"\n          on:click={function(){$curVerseIndex -= 1; scrollToVerse($curVerseIndex)}}\n          disabled={$curVerseIndex <= 0}>↑ Verš</button>\n  <button class=\"btn btn-primary\"\n          on:click={function(){$curVerseIndex += 1; scrollToVerse($curVerseIndex)}}\n          disabled={$curVerseIndex >= curVerses.length-1}>Verš ↓</button>\n</div>\n"
  ],
  "names": [],
  "mappings": "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"
}